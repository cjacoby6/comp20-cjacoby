<!DOCTYPE html>
<head>
	<h1>Security Assesment of rocky-springs-2538</h1>
</head>

<body>
	<div class=title>Introduction
		<p class=text>This is an assessment of a server that stores user logins, locations, and the time of their last check in. The server has three states, "/" which lists all users and information in chronological order, "/sendLocation" which takes a login, latitutde, and longitude and adds it to the database, and a "/location.json" which takes a login query and displays the latitidude and longitude associated with the login in json format. 
			In particularly, this security assessment was done on the instance of this assignment hosted at https://rocky-springs-2538.herokuapp.com. This particular implementation is the work of the github account hunter~.
		</p>
	</div>
	<div class=title>Methodology
		<p class=text>My testing of this assignment was done in a black-box format. I exclusively used curl and a web brower to stress the server and investigate how it would respond to faulty input. This was the method that brought led me to the potential security breaches in the code, although after identifying areas of concern I did use the source code to examine exactly how the vulnerabilities existed.
		</p>
	</div>
	<div class=title>Abstract of Findings
		<p class=text>The security faults I identified mainly stemed on relying on user input following the expected input. This was an issue from the relatively minor problems of the script not rejecting non-number values for latitutde and longitude to failing to produce an error when any or all fields were missing. Because the server relied on field attributes that had not been checked, requesting the location of a username which had undefined or NaN fields crashed the entire application.
		</p>
	</div>
	<div class=title>Issues Found
		<p class=issuetitle>1. XSS
			<ul>
				<li>POST - /sendLocation</li>
				<li><span class=severity>High</span> Severity - with a scripted attack the hacker can direct the webpage to do anything it wants, from redirecting to a malicious site or presenting false information.</li>
				<li>Simply experimenting with possible inputs for logins and previous examples of XSS helped me find this issue.</li>
				<li>This threat can be mitigated by converting potentially worrisome characters to their HTML equivalents. This would, for example, convert "<" to "&lt" while still displaying correctly. A possible fix would be to use the npm-installable api html-entities where entities.encode("<>") would return "&lt;&gt;"</li>

			</ul>
		</p>
		<p class=issuetitle>2. Unexpected Input Type
			<ul>
				<li>POST - /sendLocation</li>
				<li><span class=severity>Low</span> Severity - while it is a large security breach to take in input of a different type than expected as then it might not be sanitized correctly, the issue is partially dealth with by using parseNumber() as when latitude and longitude are not numbers they are simple stored as NaN instead of their actual value. </li>
				<li>I found this issue using black box testing with random inputs. </li>
				<li>This issue can easily be fixed by checking the value of input for NaN or other unacceptable values before storing the values in the database. If that is the case the code should not store the values and instead return an error message instead. </li>
				<img src="NaNinput.png" alt="incorrect NaN input"> <img src="NaNhomescreen.png" alt="result of input">
			</ul>
		</p>
		<p class=issuetitle>3. No Field Checks
			<ul>
				<li>POST - /sendLocation</li>
				<li><span class=severity>Moderate</span> Severity - this opens the website up to taking any sort of input, from missing or additional fields to even input that is not even a string or a query at all. Bash does check for '(' so inserting javaScript of nodejs code seems to be out of the question, but that is an issue a skilled hacker would most likely be able to get around. Regardless, it is a gaping hole that the code takes in any type of input, even though it only inserts NaN and null into the database in response.</li>
				<li>I found this issue using black box testing and simply expanding on the problems I had previously found.</li>
				<li>Fortunately, checking input type, the fix for issue 2, should additionally solve this issue although it will not test for taking in extra fields. However as the extra fields would not be stored, that is a minor issue.</li>
				<img src="missingfields.png" alt="input with missing fields"> <img src="nofields.png" alt="input with no valid fields"> <img src="post-faultyfields_homescreen.png" alt="result of faulty field input"> <img src="non-string_input.png" alt="attempts to input javascript of node js as data">
			</ul>
		</p>
	</div>
	<div class=title>Conclusion
		<p>
	</div>